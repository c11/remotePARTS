<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Clay Morrow" />

<meta name="date" content="2022-02-10" />

<title>Alaska</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Alaska</h1>
<h3 class="subtitle">NDVI analysis {remotePARTS}</h3>
<h4 class="author">Clay Morrow</h4>
<h4 class="date">2022-02-10</h4>



<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>This vignette will demonstrate the main functionality of <code>remotePARTS</code> by working through a real remote sensing data set.</p>
<p>First, install/update <code>remotePARTS</code> from github if needed:</p>
<pre><code>remotes::install_github(&quot;morrowcj/remotePARTS&quot;)</code></pre>
<p>Then, ensure that the package is loaded into your library:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(remotePARTS)</span></code></pre></div>
<p>This vignette will use <code>dplyr</code> and <code>ggplot2</code> for visualizing the data:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Attaching package: &#39;dplyr&#39;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="do">## The following objects are masked from &#39;package:stats&#39;:</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="do">##     filter, lag</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="do">## The following objects are masked from &#39;package:base&#39;:</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="do">##     intersect, setdiff, setequal, union</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Warning: package &#39;ggplot2&#39; was built under R version 4.0.5</span></span></code></pre></div>
</div>
<div id="alaska-datasets" class="section level1">
<h1>Alaska datasets</h1>
<p><code>remotePARTS</code> ships with two data objects Both objects contain NDVI values, derived from NASA’s MODIS satellite, for the US State of Alaska. The first object, <code>ndvi_AK</code>, contains pxels for the full map (n = 31,486) and <code>ndvi_AK3000</code> is a representative subset of 3,000 of those pixels. <code>ndvi_AK3000</code> exists as a smaller data set that can be processed much faster than <code>ndvi_AK</code> but both sets contain all the same variables and can be analyzed similarly. These data can be loaded with <code>data(&quot;ndvi_AK&quot;)</code> and <code>data(&quot;ndvi_AK3000&quot;)</code>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;ndvi_AK&quot;</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;ndvi_AK3000&quot;</span>)</span></code></pre></div>
<p><code>ndvi_AK</code> is a <code>data.frame</code> with 38 columns. <code>lng</code> and <code>lat</code> are longitude and latitude, respectively. <code>AR_coef</code> and <code>CLS_coef</code> are pre-calculated coefficient estimates from pixel-level time series analyses via AR REML and conditional least squares, respectively. <code>land</code> is a factor representing land cover classes and <code>rare.land</code> is a logical filtering variable that indicates if a pixel’s land cover class occurs in less than 2% of the map. The remaining 32 columns, of the form <code>ndviYYYY</code> contain the NDVI values from 1982 to 2013.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(ndvi_AK)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="do">## &#39;data.frame&#39;:    31486 obs. of  40 variables:</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ lng      : num  -141 -141 -141 -141 -141 ...</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ lat      : num  59.8 59.9 60 61.6 61.7 ...</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ AR_coef  : num  -0.00625 -0.01282 0.01049 0.02801 0.05349 ...</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ CLS_coef : num  -0.0106 -0.0135 0.0134 0.0175 0.0325 ...</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ row      : int  362 361 359 340 339 338 337 336 335 334 ...</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ col      : int  467 467 467 467 467 467 467 467 467 467 ...</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ land     : Factor w/ 10 levels &quot;Evergr needle&quot;,..: 4 5 8 8 6 6 6 6 6 7 ...</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ rare.land: logi  TRUE TRUE FALSE FALSE FALSE FALSE ...</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi1982 : num  6.17 10.43 5.46 2.35 6.66 ...</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi1983 : num  6.23 10.64 5.19 2.2 6.49 ...</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi1984 : num  6.62 11.02 5.22 2.65 6.71 ...</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi1985 : num  6.01 10.08 4.75 2.64 6.47 ...</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi1986 : num  6.29 10.16 4.88 2.87 6.89 ...</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi1987 : num  6.31 9.53 4.9 2.67 6.59 ...</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi1988 : num  6.5 10.34 4.61 2.63 6.39 ...</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi1989 : num  6.76 11.17 5.66 2.77 7.16 ...</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi1990 : num  6.87 11.17 5.8 2.52 6.78 ...</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi1991 : num  6.01 10.58 5.49 2.59 6.84 ...</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi1992 : num  5.8 9.82 5 2.09 6.22 ...</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi1993 : num  6.88 10.79 5.46 2.47 6.63 ...</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi1994 : num  6.34 10.85 5.33 2.3 7.04 ...</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi1995 : num  6.03 9.83 5.03 2.75 6.85 ...</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi1996 : num  6.7 11.51 5.69 2.53 6.7 ...</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi1997 : num  6.59 11.38 5.53 2.8 7.03 ...</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi1998 : num  6.37 10.79 5.11 2.87 7.06 ...</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi1999 : num  5.74 10.22 4.91 2.65 6.74 ...</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi2000 : num  6.5 9.79 5.32 2.55 6.69 ...</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi2001 : num  5.68 10.66 4.33 3.18 6.44 ...</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi2002 : num  5.94 10.53 4.85 3.17 6.99 ...</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi2003 : num  5.72 10.09 4.69 3.3 6.65 ...</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi2004 : num  6.27 10.67 5.91 3.05 7.27 ...</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi2005 : num  6.4 10.71 5.6 3.03 7.08 ...</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi2006 : num  5.94 10.71 5.62 3.23 7.45 ...</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi2007 : num  6.52 10.47 5.54 3.01 7.5 ...</span></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi2008 : num  5.85 9.99 5.33 2.94 7.48 ...</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi2009 : num  6.43 9.22 5.84 3.04 7.91 ...</span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi2010 : num  6.6 11.64 5.96 3.28 9.16 ...</span></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi2011 : num  7.09 10.31 6.99 3.57 8.41 ...</span></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi2012 : num  5.04 9.14 4.02 3.06 7.78 ...</span></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi2013 : num  6.66 9.86 4.95 3.14 8.42 ...</span></span></code></pre></div>
<p>Both <code>ndvi_AK</code> and <code>ndvi_AK3000</code> have no missing data. <code>remotePARTS</code> can <strong>not</strong> handle any missing data. It is essential that <strong>all</strong> missing data is removed prior to conducting any analyses.</p>
<p>We are interested in asking these question of these data, “Is NDVI in Alaska increasing over time?” and “Are Alaska’s NDVI trends associated with land cover classes?”, and “Do Alaska’s NDVI trends differ with latitude?”</p>
<p>The below figure shows a temporal cross-section of these data: 1982, 1998, and 2013.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>reshape2<span class="sc">::</span><span class="fu">melt</span>(ndvi_AK, <span class="at">measure =</span> <span class="fu">c</span>(<span class="st">&quot;ndvi1982&quot;</span>, <span class="st">&quot;ndvi1998&quot;</span>, <span class="st">&quot;ndvi2013&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> lng, <span class="at">y =</span> lat, <span class="at">col =</span> value )) <span class="sc">+</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">col =</span> <span class="st">&quot;ndvi&quot;</span>) <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> <span class="fu">gsub</span>(<span class="st">&quot;ndvi&quot;</span>, <span class="st">&quot;&quot;</span>, variable), <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;magma&quot;</span>) <span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Longitude&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Latitude&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>And this figure shows how Alaska’s three primary land cover classes are distributed:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>ndvi_AK <span class="sc">%&gt;%</span> <span class="fu">filter</span>(rare.land <span class="sc">==</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> lng, <span class="at">y =</span> lat, <span class="at">fill =</span> land, <span class="at">col =</span> land)) <span class="sc">+</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">end =</span> .<span class="dv">9</span>) <span class="sc">+</span> </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">end =</span> .<span class="dv">9</span>) <span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Latitude&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Longitude&quot;</span>, <span class="at">col =</span> <span class="st">&quot;Land cover&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;Land cover&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="model" class="section level1">
<h1>Model</h1>
<p>When using <code>remotePARTS</code>, generally the data are assumed to follow from some process</p>
<p><span class="math display">\[Y(t) = \alpha X + \varepsilon(t)\]</span> where</p>
<ul>
<li><p><span class="math inline">\(Y(t)\)</span> is a response variable of interest at time <span class="math inline">\(t\)</span>,</p></li>
<li><p><span class="math inline">\(\alpha\)</span> is a vector of effects of the predictor variables <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span>,</p></li>
<li><p><span class="math inline">\(\varepsilon\)</span> is an temporally auto-regressive process: <span class="math inline">\(\varepsilon(t) = \rho_i (\varepsilon(t - i)) + \delta(t)\)</span>,</p></li>
<li><p>and pixels are spatially autocorrelated according to spatial covariance structure <span class="math inline">\(\Sigma\)</span>: <span class="math inline">\(\delta(t) \sim N(0, \Sigma)\)</span>.</p></li>
</ul>
</div>
<div id="time-series-analysis" class="section level1">
<h1>Time series analysis</h1>
<p>The first step in a typical <code>remotePARTS</code> workflow is to obtain pixel-level trend estimates. In this case, we are interested in estimating the time trends in NDVI for each pixel, represented by <span class="math inline">\(\beta_1\)</span> from the regression model</p>
<p><span class="math display">\[ y(t) = \beta_0 + \beta_1 t + \varepsilon(t)\]</span></p>
<p>where the innovations <span class="math inline">\(\varepsilon(t)\)</span> follow an AR(1) process: <span class="math inline">\(\varepsilon(t) = b\varepsilon(t - 1) + \delta(t)\)</span>; and random normal <span class="math inline">\(\delta(t) \sim N(0 , \sigma)\)</span></p>
<p>We will use <code>fitAR_map()</code> to estimate <span class="math inline">\(\beta_1\)</span>, which fits pixel-level AR(1) models to a map of pixels and estimates parameters using restricted maximum likelihood (REML).</p>
<p>To do so, we must extract only our NDVI columns as the matrix <code>Y</code>. We’ll do this by matching all column names containing “ndvi” and slicing the data frame:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>ndvi.cols <span class="ot">=</span> <span class="fu">grep</span>(<span class="st">&quot;ndvi&quot;</span>, <span class="fu">names</span>(ndvi_AK3000), <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">=</span> <span class="fu">as.matrix</span>(ndvi_AK3000[, ndvi.cols])</span></code></pre></div>
<p>We also need a 2-column coordinate matrix <code>coords</code>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">=</span> <span class="fu">as.matrix</span>(ndvi_AK3000[, <span class="fu">c</span>(<span class="st">&quot;lng&quot;</span>, <span class="st">&quot;lat&quot;</span>)])</span></code></pre></div>
<p><code>Y</code> and <code>coords</code> are then passed <code>fitAR_map()</code> with default settings:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>ARfit <span class="ot">=</span> <span class="fu">fitAR_map</span>(<span class="at">Y =</span> Y, <span class="at">coords =</span> coords)</span></code></pre></div>
<p>Coefficient estimates can be obtained from <code>ARfit</code> with <code>coefficients()</code>. The first column is <span class="math inline">\(\hat{\beta_0}\)</span> and the second is <span class="math inline">\(\hat{\beta_1}\)</span>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">coefficients</span>(ARfit))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="do">##      (Intercept)           t</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1,]    6.948403  0.00646569</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [2,]    9.769477  0.03364822</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [3,]    8.878754 -0.04692621</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [4,]    9.576697  0.04272702</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [5,]    7.405569  0.03244062</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [6,]    8.002038 -0.02781490</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>ndvi_AK3000<span class="sc">$</span>AR_coef <span class="ot">=</span> <span class="fu">coefficients</span>(ARfit)[, <span class="st">&quot;t&quot;</span>] <span class="co"># save time trend coefficient</span></span></code></pre></div>
<p>Below is an image of the estimated coefficients (pre-calculated) for the full <code>ndvi_AK</code>. From this, we can see that the general pattern is for northern latitudes to be greening faster (slightly) than more southern latitudes.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>ndvi_AK <span class="sc">%&gt;%</span> <span class="fu">filter</span>(rare.land <span class="sc">==</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> lng, <span class="at">y =</span> lat, <span class="at">fill =</span> AR_coef, <span class="at">col =</span> AR_coef)) <span class="sc">+</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span> </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradient2</span>(<span class="at">high =</span> <span class="st">&quot;forestgreen&quot;</span>, <span class="at">low =</span> <span class="st">&quot;darkorchid&quot;</span>, </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">mid =</span> <span class="st">&quot;grey90&quot;</span>, <span class="at">midpoint =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span> </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Latitude&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Longitude&quot;</span>, <span class="at">col =</span> <span class="fu">expression</span>(beta[<span class="dv">1</span>]))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACHCAIAAAB76TeLAAAACXBIWXMAAAewAAAHsAHUgoNiAAAgAElEQVR4nO2dWWxkV3rfv7Pdrfbi2mRx6y6ypVJLM9rG0rTl8dgzdjicOLQ9EWAkhuEXEUhgMAjCeck8BeOHhIAjIskDDdiBMbYTKJOABoYiIARjT0ZtSTNqjZYW1c0qNrcqNptb7Xc9Sx7YYre62SLZ3dw0/OE+VNW9h/c798/v3rN857tIKQWnnGTwURtwysNyKuGJ51TCE8+phCeeUwlPPKcSnnhOJTzxfNEkzC8U3s9ePmorDhX0Rerazy/Nrds3ESCEMMX0qfTTR23RYfAFkfD64qwd1AxqIQCppO6H66yEAVf88vPnX1hYmu/q6D5qGw8KetQGPBT5+cJGcDOqx2/WChQzl7tRPbZur7aGqYmsQAYa0QAAY/LJ3MeP9zxx1PYeCCfVCz+Z+xgAlFJCcgDQqekLjyCiES2QAZcBl5xiKpV0AptieibS4XD7RnWpI9Zzs3YjEJ5G9LZwl4CgM9V11LV5KPYkYW5saHQa4MqVKy//1aWByaHRaYDM4Phw/yEYeA8fz34YRQ2cejoxKn4pwuIlb50RzWJh8BHW0UJpNmE22EG90WpGCDtBXSqJAAUyqPpliqjJrNX6DYuFk2YjI5oGRntH21FU5dGwdy/MjQ1NDowPZ4eGYHy8/9a3NAA899xzAPDuu+8epJ23+MXMuwghg5pC8ogexwgrUCV30+MOxVQjhkENoYTHvYTeuOmuAkDUSGzaq4EMMMImC1FMz3c/fm3+k5KzSQmL68lAek5gR/SYJzzbrxFMn+l7/oPsexRToUTJ3fy1C795CFV7YPbcqZganR4cTm9/TfdlPv347rvvHo5+l6+9E9GjSWilmOrUwAgjhYXkbmBjhHViEkyUUgiwQc2Kv6lTAwBW68tSSYuFwlrUYiGG2ZXZD4UUClRUjwfSr/rVRtbGsBbTExhhBOjda29H9XggAy55wmh499rbh1C7B2avEk5NwOCd983czPRBmPO5NIfbTBQmBgJAGGGEEIdgSx6lVFRLGNSkhEklMMJSSZOFFKgGs1kqaQd1J7CFFEopgggjWms45Qa2Qc22UGdJrNlBreKVan6VEhrV455wDWo0szYF6kyo8/3s5atzh1/jPbHHFunUBAyOAwBA/2BmaGhqBqYzI8MHaNc9LOYXAABREkjf4XWLhWteJZA+RlinZtRI1IMKxUwjGkaEYkYxc4I6wbTobihQFFMFquZXwlokpidqQaXuV+ygLpSwg3qIhRVA1SsLxaNaPJABxYy6BmgAAPnqXFOo1Qnqh1nfvXNiWqSF/LJCYtPZoJgyojHMql45rEU94VLMAECnhsudTXutMdTic08jmi+8iB5fqRVCLMQVdwMHIawT3WBWza9s2muNVovBzHx5oSXcFtYiFa+UgOZ1dePp3ud+fvWtNqsLABQRQgqGtbJfPJ7dkpMxwLawNM+VX/UrUgkhuUa0QPg6NXVqCMkNsALhoQArJRNmw6a9JkEW3U2dmoH0MUJlr+QGTkgLt+opLgOMsMddjeiB9G2/rlNdKL5hrxrUBAw+9/LzhZiRaO9sKwbrvvAIppvu2lJ57qgvw84cUy988+O/T5pNUT0ulQykbxBzpZaXoGJ6XEgulRRKAAAjmpCCYOIEdaUUI5pOjKK7gRFGCFs0ZGmhslvc6u+HtahUQioVSJ9iqpRimAUySJgNFLQb9aWk2SiUcAPbZJZG9EJ1MarHy+5m3GigmNaD2tO9zx31hdmBY+qF3aG+KE5gwAihqleu+mUFyiAGl4ECUABcco3oDGt2UBOSI8AmCwEgT3gWCwklEMCavbJprxnUDETQaDX7wtOJwaXfwtqlkjo1uOIWCzGsFWrzLTSlKaO3qw8hVPUqa/ZNhrWisx7V40LyorNe8ypHfVV25phKCEyt+ssVv+Ryxw5qdb9KMOWKm/WEL7y4keAy2PJRgqkd1AGUQc2tmySXvMlqQQh3RLtjRoIgUnI3Xe4AAMakWWvn1NewxjCLec0ed5WAM7SL28pH7sz8tZpfRQjVvHLJ3cSIrNk3V+s36kHdE+5RX5SdOaYSptpTLVZ7VI9vuU5TqNWgZkuorW5tNlot86Vc0mySvqr55RALO4HNJS+5m77wuAwopmWvFNGiBgmV3KLLHamEQa0Gq7nmVxBBGtEpZmWvREPIoGaFFytok0XQan0ZQFksxGWgU9NklhPYHndDWkQnelSPH/VV2ZljKiEAtKfaKl4prEUTZmM9qIVZRHGI6fGyV4zpCQWqriotRkoq2RRqJZj6wjOo6QsPI8ww45JvuqttkY4Gs1mjho7Mm7WCx11EQHEAgITR4CHboGYExR1uIwxJs0lIXvMrQgoEwDDDCOOtITpQSsl9WJ8bu4gQQhfHcgd0eW5zfCUEgMd6MlAjCKEoSQglfORV/UqYRUJaGABc7igiYzQZFokWox1ARfV4U6i15BYJpnZQS2rNQUXyumqyWhBRACgV6V6zV1ywhRLUNQrVRa74op0LhHfDybvccbjDJReKU6zZQd2gZsxISCU1ou2r1ZebnH751Ve++tULfendD35IjrWEAND1WKqn46ySCiNcdjcpZgxrZbcISllaGEmsiCyhVQ+cRqtFB1NDRk+kL84aLBYCAGIgRAAL6m0oAGXzetJorHplk1rERGEtsli6jhGOGQmPO4EMXG4DAEG04hUppkLxmldNRbu54FKJ/Zk+MH7p0uDEWA4AclNTB+eNx13CLRBGUskm/YzFQmVvM2okQlqEC3/FyZfcjZieYERToIKqrPMKorBiL1W9cm2eB8TDOlIBUBOdCXXq3Kp4JZc7Nb+y7q4gQD2JXi45AhwzEmV3MxXtjupxg5ot4XalVMJoSJoNZa9oMvMBn4XT2dzU2OTMo74id3AypnwVkRSYL1zBhclCDPSaX/GEF9YioKDkbiiABtKKY8j2OSgIa1GyHrbSBICWvaLpxiAWKFuzWbnu1UxqbThr3fH0jVq+6GzU/VpMTyTNprjRIJWMGw1r9gojWku47dr6lSdbnlWgAuHrdnhfNk+PXkR/Dq9mL6XT/QMwdUBXBk6KF6baUwgh4ul8VpNK+pvSoCbBJKLFpJKNxplG1lpHZQE8LBK8riwRRc2uVBIUhEWcRTFTOg0jrRwRSmw6axjhpfIcArRcXWqLdFha2Ob1ildSFcxA22rIVL1ya7gdAZJKUsz8yn6aMwCZkUtKXRo++GfhMR2duR+FxeX2zrbZhWzNrzZZrVwFAIAQ9rkLCBlgcRyIdawlsAt1WrNYBCulynzDrCZYBIMhV2oFIfmNav5soi+sRxGgdXu1JXSmUF3UiNYW6RSOuhEsRPV4IPyk1lwM1kxqAQDaNM4+3XHUF2AHToYXbtPe2QYA57p6V+srSkHFK/vCRwFWAAwzgTkCJOI2psiAkB+qAQZFZVQ1aAkMCorOukmtjvDZ5lDrurPKZVD1yzrRl6uLnbGzIRb2hLsSLCbMRoOaGBMlVNhpQAjP/4XQG8hR135njrUXLs4UgopEGLCOup9Ibf9eWFx2VE0pZYgwwgAIaqqMAPnST9BGXlWOVWJEB1BcciF5WI9t3RhL7qZBjYpX/vUnvwkA1+Y+oYRtTVkokEV30yAGI5pBzUD4urQQQYDh5k/ccCcNddGtf6DjxvH1wvd/OIcZsBjWGwmvfeb/TCmlEd3hDhhSCQiIF0YxCTKsRZQAHBdhSJgoZLKQQc2E0QigfO4a1IjpcQDUG39ibvH60mwhhKJC8qTZiBDSlNngt8WMpE5NiljZKykJhTecalBq+ZqBdSSDY/q/fkxbpEvXC7E+JlwFCIKqoiGU+9kStVD3hVQhv4wwAoCE2YAVCXRPx4ar7ChOgASb1CwIe9Qpe8UmeQZzTRgcu8ywGAKU27zWHu30lAMAxERKgOlHHFJVUhGu+eE65WGOAl+6FguBAL8qIyyOMJhtZPWnbse5fVThu//nX+96zH/6vf/2oFfoNsdOwvx8wS9JLYZxgiOHgQISAiUAUXCWxcK1PAmDchFm1Eeujk2CaVCWBBmuVTdpiJUtwRQO9OZom3QVZoAUFVKt12/OlbJnIqk4bSjzDctJ1MNVDBgxLLjwlcc0LfC9gr+eMBuqXiVuJlUAnd+2FFec8uJb0nxhf8PcDLMDukR3cbxupPmFAiDwohXJBFVaoNtYB2dFbA1PhropQgh8hEyFGTKICVhJKRBB0geKmbch/U0pfaU4BCUJGKQH3rrAGgjFH298iiLKcSCVxBrS6iGEMMUskP6afXPTWdeIrhGt4pUjehQBUlLVaaksNhhmjV/RfOHtqy4Ms123R3LRjpeEqa72VFd7BMVXanlel1JJJYFoSAmFNeTgKg0h4SrlIb8olQCkkC88REBJhWymN2IlgNeUcBRmCBGQXOlNxEH1RqtFp0ZjqIUElGKGTKEiAcW0flVhhOt+bdNd/+DmzwlmBJHl6lLdr2INaRvRmJH0uLv+jr8VD7d3GGG7bo/koh0vCbdI9bQb1NzyPMUB64hGESjQ6mFeU8RCoAAUCFcJT5koHNQkooibLgDoTZhYSItjwCActSW57oXsoI4QhhpFmpJKYqDV9xFFrJZaZkTvjJ2liMT0xGL5ugJ5NnE+qTdLFkhfYYTtoI6eLu636c6wtuv2SC7X3p6FubGhUcjANIyMD8PY0B9NwwXIjIwf0NDDa2//4CvtL3Hm2H5tyZ3vifcqxZQuiaLODWH0gHIwDSHJwSM2I4xaLKhI5hieI4iFHbNiBlFMYR1uNkIrSEAEIiQuPeWVJQ2RiB7j0k88xbgK2qNdZbeoEe2smUGmwoBrc7zWVjZpqB7U/Ea3VsO+cClmsVrzvmrxqJxsV/bkhVOj04PjAwMjI8NpgOx05nsjI3fo99xzz20FdD8qXn7hDx1et4NazG9JJx9DCAUyCGQgucIacmah67EUd1SgOwY1oUqVUiyGlVKAkF+UdCMsA2XnRdxv4TVFTMSZp5QqfuibbQRheHvpH4ruenWGg0v/7ur/pJhihImJbv69/9HqZZRyQlqUEiZkENFivvTiRoNODSdc3lcttgIhP3+7fXRubGhoaGho7DNjqbmxi0O7D67u8UZ6ZWIsmx0dHZqCHGQAACaHhj6dzTyIaO6KW2q0WlTEF0rU/Sr1dI2bK2rBSpHzX+sEABbGzDO31sQIR2EKLIKL5g29EQtXERPRCBKOkoGSnnK4jRgknifCVW3tbU80Px2ttrAoJhZ868zLJoRDNLrprptN5FzyvM3r19Y/klI0hc74wmsJtYW1qE7Nul/dVxX+5Bvf/ZNvfHfHR+D2ru2Dp0anB8fHx0dgYnuOODc1NgkX9nCiPXYqLgwO9/cDzIzlYGBgIJ1O9w/CUBbgoAZxf+Xxi/f+2AHtWx/ml+b5DaK3K3AYigisEeEqAGgJnZFKWO1EeEqLYQ/bOglVgmLuP6K+l7neSFTcnb+SN6NWzzMdhfyyUxCisWZSK7sx3XT9sQu/2zW/NBfRYrZer3ilq+sfPdnyrFSy7BVd7uhkf82Zv/jJf4X7dC3uu+uOZQ6Q7h8ehqGh3U+0Jwn7RzJDQ2MzMA0j4+ns0NDkYGZ6IjMyvpeyB0F3R/fcZt67AUoIPUmEq6SvfMsOQRgrHDhSi+GgKokwIQZGJXbuu8WIxjbcm420pVbkZbbqzjlhFWdhVHlbD32VppOPkxi7NJYVnkp900xFzm78wm9/orPqlc9EOnRsKrW+3/lCRvbfWsnNTEPvfgvtKGFuamx0pm+wr7e/f8vN0sPj23qlx8f7AeBIFqbdhpgIUUAE8ZrUm4n0laNUIH1kMxbB/qYEBDQBvnD0JrPuqMVKrqnaExi+3oPaoFMA94WjRXV4dqMuw1LIelALfYuazDI0UqgsJLpSTfH0pr2GAPyijIUbJPB9Wbivbt9nljlMbS0e22vZHYa5p8aGoC8zA8N9M2MwfDSLCHdl6XpBcQgqkhholS62mV0gAWsoqEpiIn9Tagls5wVvK9f9WsxIVr1SU+jMVvAEQmipPNcR7SGc1VE1xEIe98reZkuozbup3Hg5qsev/Xmt9UUjOLcOAI3sTFlsaETv7T6/dwt/+M5f73rMd37lXz7wFdhmx+ZMZsub9+3S+yH3zhIAzC89YJS7dFWdlaiF6maRS14RRcm49JW3JhFCioNzQ5htRAEYzFquLnLJV+vLGGEGOkNaR+xsza8GxN2wVxHC57rSz/R9xeG2Gy/Nl3KL5Vn6nXz8KRY3Grnkq/5yFBosbX+z9vtrkT4EO0jYPzwwM/raa98fmuw7KBdczC/8qPKD3EJ2ubqUXdh3YMlitkAsFPLjG3Q5HCQ6zXMxmsQBVZo0zxBel6jF12I4KEt9LR5xG9LhjMPrjGiBCG46BUBwo7oYkcmF8mxEi9a8ypXZD3529a10V9+6vfqtZwa7YummUKvHXQ1r0fU2X3hKgO3X9mXkoXXt77qR5nJT2eztr729/emDjhz4ePbDuNZYDjYyZ5/c8YD5j/PCVuee78jPF5QAXlfSV9RCQciWSloqElQVi6CiXG8wmxQHwLDxrtf4vL40aSd/S+heeBWWmkNtWJAy30wYDW3tbdmFmRALX1l971zi/HJtKarH1+ur55LnfeHV/drTfc8BwHJhWUng4GNMal5FKHHh3FN7r9cb7/9o12N+68vf3vsfvB93eWE63dsLMxMz0Nvb2zszMfnwJ9gVg5rtHW330w8AXKvC4njxWsHbkMJViAKLYhrGzLYMPyIDQBQ49RuMpqpXBgy8JhNPar70Uv2WIcPS8stukWIqCY/wZFt7GwDoRJdKZOJPS1AWDcX15LnkeYBbc1iL+YXZhWyhtrjprxHBCCJRLYER2le9jm6YO50GyAz0p9Pp9EAGsjuVebSc6/q8Z+7CdJ6shLEliYV4TUlPIQS8LgEB1lGNbga6TS1U8UpC8ZK76RclDWNAQLmmsKzCJuVag9X83o23O1NdnefbAWDx2laGEweY0onucJtgGgj/RnWRYc3ljpBCI7pO9LieEJR7wuXKZ0TfV70Y0XbdHurCfcpOz8KBvsmhixcvDk32DRx5c7Qrk2IRzEto3V0J9xKsI+EphBGvSawhjegGCrnIjstmFJA21u2HqwpJJUBJWLdvCiUBg0b0bz/7e4XlwuK1wmJ+0TfqflGyusVlEMggaTY6Qd0TXliPSZAIkE4MqaRSaqW+XPGKZbdoBzW8bu7L8kNrzuzQL8wB9A1+73uDtz4ffBTd57GUX6QR4q3KhlCLqAIooGEMhkA+AQWGCjlQN1EIhcAvSumrUEsECUwsGcgglG9ai80nWVPm7IV8Ycm/CVoSY0QV0bueSC0vL/sCqG2YUUsGygOv5pW58D3hVf0yw1rSaloozWJAlhb2uOtFVwH2EcH2qForu7KDhOn0rTvb5Ohkb/+hLqi/FwyUY18pYueF0UKCiG3RkLCJkqCQKn0c8PMVToOwiMlA0RAGUEoohDF2NaMZWlnbiptHy+CtQJCs6CwWVBUKo4+vfxTRonZQD4XCa/amkKI11B7HDZJxotiae6PRbG1vb6t5lY9uXr7Y8Q0pVUmt7cvyQ5up2HF0Jr3VDO0DOMBh0D2QXygoDnyTEBMRHQlXadLyHKnF8NYCh8TTrFD1Gqxm5YAfr9Ag7ixKK0U96SBbBwQg9ZZYOwDQFknrMa+oAIMewRRRWSJG1CSSJaEFh6HmVwSIMEQQAZNarrABIKLHLnb9pscdjRgG2t+N9NACL3a6kW7legLIDB5uUovPsnAtTyPI35A0hISvtCakPKQE0BDyS5KGcVCUWgK3h7sVV9xTFov7ZUnaA1d6zLdIAwIA6SkZAGgSAALDJp4VVKTeSEIQRUmo+4EALghf27zZYDXPl3J9DZmKXcIfNIW/EhSWC6n2W5GPC/kFA/b5LHxErZVduac5k8tlITMyMjIyMtI3M3mASwF2o+t8SvmgNxKsIxbFvnClFgjdK7zhaHFMLHDjpaJYW3dXEEIsggEBNZEmDJOGlFCusNecG/VF/mH1bQy4K9UFNwwllNFMVKBAU9IGgmlv93mp5EsXfiNz9sK55HmLhZusVvx0SSrJy7d6zHNL17tSXRWvtC/799epuHe+cMcZxJ24W8IcZGempyez2Ww2C0faIp2+fsWGalCV3FZBWRLbIAFToFL/xFwNlkGgKEmGtWgDaRGY+yUpPUUsBJqSIF2j6ksvWmu22ulj8isSJABoSeKuCl6XRbnmBPXqHIdVfW7x+naXNMQi+cr8urOaNJsMP4IwKiwu5+cLa/UVAHhiP/16AOju6Onu6NmxL7G9a/vge+cLd5hBvA9330jT6f7hvQ+SHySZsxfmPsj/wnvz2fhLQkFQVsoCZhkd59r9BVvgAACCBVpvXY/zRgFKSXBXhNVBfeVYIoowcE3RECqiNcQjs4s5BibW0dmnOwA6Fq7mtQ6ozXOj+Y7FLhx95bGvLl0vBNJb4QVKWHMtRcO4TX+QVImFpWUA2Bou2OuuO+cL7/fLPdwlYW5sDAZgdPRWrqqDi4/ZEz1fSrGFl4KyEo6CVre7qxcAZheygBA4dOX/ual+UwaNKgDFFYthXgdvTRBLDxypNxAUDYIapYxp3Oo41744UzDO3bo3dj2WujL7gRZOnOtMFwr5ml81vEjXY6nr7y/VF4V/fv3FzEuFpeUqL+nFKDH2Ny6zheT7j/6+d75wDzOId0mYHh7ITU1mRkYGACA7OXm0LVIA4DXV81QKAK6/tzS7vkRDyLBCiEDhTefM1436PMc6QgQQQdgEPUmkUDK4tbjX575B2BNnn7x87WczH3zYk+g723Hug/8996Xf75lbvG4Wk8gCAGhvv71aQzjqyd/pfvuTpbemf/pi5iWAtvdmft5itj+A5SrYx8E7zBfuOVHa3fOFudzU5OgEDA72AQBsz/keDdl/XKRhrKQymolwlBIQVKWWwJihwhsOwtD4rE50hHXw1uWWrxADKQHCVSjJGWhAlMcdnZj2ouh9sXPhah5TNP939dQ3LGKhreC2jvRtha78aF5vxKV44fnHXnxI4+c/zu96zJ1rfR6Yu5sz6XT/8PhI361v2Ue+QvzP3vjTvR/c+9VORIFoCAC4rYiBtBjO/W2t/EmQvKC1fpMREymplAQaRiyGEYFAcz29JuIO5UwJJWrgC3/TWTNbCQB0PZYSrqIG6vlSSnHF67J89TPOkviythqda0GdV3+88POrbz1MTRXffXsk7DBGOjU0CjAzA70zM49+ifi//a1/v+sx8x/lF2cKs5eXAKA7k8IxZQc1GXWUVN6G7PhtSwlVz3MMlFclZojXlHCVe1PYRplhtvJDZOKQvSz8kuzsaw+xcNJqSvW0A8BitkAjqPkF48rsB966RARd+Hb3naduT7VdzHwN66DFcRPvAIDc24v5ucID1FQGatftAf7svew0a5/J9Pb3wQwM9/XdmqnIjQ0NjY1txR3uub/yYPzZG9+XMZfbktdv1VAqwRxLFvSgomRLHSSEOqjRRARwGsbCVSyCeLxuniFL4xgAOr9t+ZtSi2NM0exirvqxcpdlvpAHAITBW5NGM7lw7kssivWmnWMwU93tZ5/pQAQAIP1C55b81xdn91WRQ5NwpyWiuamxbG/fxB99H753abwfYOv5OtKbg3Q6PXWkiZ0B4PJfXw9qsul5XfqK15VSgAAiaSqZUBVsFwQgcDpXQyys5qzSmaV2raf4of/U7/YAwOzlJcVhyZz++lO/fdB2Xvvp4q7HnH+p8+FPtNMYabp/OA3Qf6l3bCwHW+2ZKxNj2cHpidHB8cFbx3wmsfPD27F3nFVemg1C7TSoSrOZUBOZbcRblyxKRNjVG7SVf3Q7022p7vbZzaWGUic0w5Z+AHDu2Q4AQIdirzqsJaWfF0eanZ6GW52KO0KBt3igiMdHQtuvm2deMiVXmAIxEYtg54YgGqqyzYX/TB7/Y73lRSPV3Q4AmAAJY3RHFRc+yTs3BDvnH4Kd8hG1VnblHglzuXtboXeGAvf3HU1i523sZVHL86bndOsJSRzmbQoWwSyKNJF8Ykj5Jbn8Dy6LFnhdLpJPUtHu7q6+7bJdj6fg8UOy89AWdh99+NN+KSwtF95wWl7U1y/7yae06myQfFYLSopGkKirtctefZnHvlOJGUlNGcJWXY8/gr7XA/DhxO7xlU8N9jz8iY51xosdyS8UVACAoeNse76Q924oQIAZIkm5+ZaInKVERzShZA3TMAIEVa98vuewXO8O3v/h7hJ++TuPQMJjt9b+81n4JK8UdGdSV2Y/7ID2VHsK7hj8yk1fq8wFv/bdPgDIvr0IQHBYaZXIkZj6IDfSW1O1n30TT27s4mjfpfvPPRzHVb6fQ9fjqe5MCgC2QzoLi8vbexOPMeGrf/wv2cLScjGev+5Pcxn0fOlobqTP/MHZZ/7grArUvdv2rruKPNgStRMm4b3cmc6nOs+//r3ziKDrr9W+8thXu9HjZbd4VIb9/C9nf/6Xs5LDvdv2rtvkcrfbkXcvUeuDz+XES7jNO3+ewxr6Qf/7nb9jNX5Zn/npIoviL/U+AwD/8KfXDt+e/YzO5KYmR0dHJyeubH3b35t4Ttiz8HOwWqlXFL3/LDzzV9V4mnFb9b3UCQC5ny3piSNIn7af+cJP59mnxh5gidrJa5Hej8vX3nFeTzY8qQVVGX8eb72V8OqPF4iBtCSWAfQ8eagPxUuv7h4Kf/HfPILhkS+OF4aWW23pRdK0LDY6U08BwI//w7XYWdb0K7oKFE0e9n+qOA4DbCeIyz+Y9Suq4YK+ZM++mPm1rR/jaRbUpEMrkVCsre2wkxg+SODFA/EFkZDoOPEtx/+QpLTbqe7CnRRryMDm4esHAHI/gRcPwxdBwvkr+aYXdYT1WiO/M4qi71c7bw3lHAWHNkZ64iW8/t6SksDiEKig7+Ld0YKprgeJXHokHJqEJzzEkNAAAAVJSURBVLtfOPkn05XrPKjI91be6rrnxdhLhaUjsWoLydWu2yM50Qn2wjf/LHvhu9aNWl7Pd/zT537/3gM62o8yG7o4fRbuypmXjFpQahXdC2euPg7H7t30p8/C+/KTj/5vdzzd1dGNGMRQ0o3Uv9b1jaM2agdOJbwvvvDEOrk2t5gLXR7o+d2jNue+nHbtd+bS9E+++eWBNz/++7Pnzg+0H1/94MH6hffOF04NXZzIvLyVCfY+8RMnqUU691G+O9ILAL/6xNdni1eP2pxd+M7fPPmdv3lSBOrebXvXXUXunS/M9Y781fjw8EhmevK+gfV7zgq8nQn44LMC348NLf+zmTf/Vce/A4CXLvzG/3r7B//8hT88VAv2w/8Y/GAfu+6MOrtjvjCdTgPkxkanB8fvG2y2Nwmz05nvjQz0ptNpgKk7PgPAwYcCX5n90A5qDfWO55594bnzL2z/fpz1g/09C3NTk6MT0xm4AoNwV4BnbmxotG/k8yad9iTh7UzAMDLSd/vzlhsedChw3EjuK3PWMUH6j2C+cHCi9zV45cLo0MzgyPB9Vpntab4wl8tBOp2GqaEhGBnp3f68j6SZv3z896/9Ytdj/vgnTz/8ifbkhens6HYm4MPMCrz1qruDPssBsR8vfCi+OLP2v7Qcx07F25+8mV94kCV9v5wcRwlTVs8RThKdOI6RhD/7i9mtPM/ztYN8AfUXjmP0LHznk0vsvTPGi/XPSS97yr0cFy9cyi++ufjjZ/7F2VP99ssx8sJTHowj9sJPrn98tAZ8ATj1whPP4XnhtflPDu1cv1QckoTzS/Pnux9fWJo/nNP9UnFQN9IrP5qPZVjH2dMe+oFz+iw88RyXfuEpD8yphCeeUwlPPKcSnniOXsIHfqH6w7yJ/UhOekAcvYSnPCSnnYoTz6kXnnhOJTzxnEp44jkiCXNjF4emYDtX+8WLF8dye0rc/mnBB8n4fmfZi0NDey+7XRAAYGro4lgODjzN/D5Qh0/29VdfffWVV17f/v7qK69mlXp966db33Yp+Porr7yustlsVu2l4F0nff2VV1/fKrq/kyqlXn/11Vdf3Zu1h8XheuFWvr+7svtNjU4P3rFGascXTe1Q8MrEWDY7OnrbPe73hqp7yt5eIjK2U/LBzznp1NjMwGcTE+7htVgHzWFKeCvf39RnV8pNTcDgnUszdsgDuGPBC4PD/f3jg5mZ3P0L3qds78BAfzo9PAjT2fuXvbdgbmzitdf+6OL3X3ttdOrzT3qoHOYq3x3fqzc1AYNbizP67/uiqR0K7jnj+w5l71wi0p+d2fNJ08Pjl4YBpsbGevvTaTjiNPPbnHbtTzynnYoTz6mEJ55TCU88x0vC3NjQbi8fvuv4sSmA3NTY1I6ltnZ/0TnOeWemxoYmpreybExNTc5MTE9nBseH+3NTY6MT05lMpm9goK+vF3LZide+n+mDPujt70/npqagvz89NTY0MZ2BTB98ms1lcGT8SF+JemAcLy+8k6mhib7x8fERGB3LwcwEDIyPj8DMFEyNTvSNj48PwPQMwMxMFtK9mQsvD/T3zsxkAbZ+ulW2D6a33qg5MjIyMjO6Lwc/ORxbCXMzkOkFgHQfTGcBMn3pz/6+C5leAOjN3Bo6yWaz2b7MLu97OKkctxvplddGh6YBIDMyPghDY1O38jJMbi8aTQ8PTl8cGroAV65kBm791AevjU4NDE5PjI3NTL82PTg8PAhDY2OZTz9PTADA96cHLx1NnQ6Yk9e1z02NZfuHe6eGRk+TpgDASZTwlLs4ts/CU/bKqYQnnv8Pjw12UYAoA8MAAAAASUVORK5CYII=" /><!-- --></p>
<p><code>fitAR_map</code> and it’s conditional least squares counterpart <code>fitCLS_map</code> are simply wrappers for <code>fitAR</code> and <code>fitCLS</code> which conduct individual time series analysis. Both AR REML and CLS method account for temporal autocorrelation in the time series. See function documentation for more details (i.e., <code>?fitAR_map()</code>).</p>
</div>
<div id="spatial-relationships" class="section level1">
<h1>Spatial relationships</h1>
<p>Now that we’ve reduced the temporal component to one dimension (i.e., estimates of <span class="math inline">\(\beta_1\)</span>) and accounted for temporal autocorrelation, we can focus on the spatial component of our problem.</p>
<div id="distance" class="section level2">
<h2>Distance</h2>
<p>The first step is to calculate the distances among pixels as a distance matrix <code>D</code>. Here, we’ll calculate relative distances with <code>distm_scaled()</code> from our coordinate matrix.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>D <span class="ot">=</span> <span class="fu">distm_scaled</span>(coords)</span></code></pre></div>
</div>
<div id="covariance" class="section level2">
<h2>Covariance</h2>
<p>Next, we need to estimate the correlation among points, based on their distances.</p>
<p>To do so, we need a spatial covariance function. In this example, we will use an exponential covariance function to estimate correlations: <span class="math inline">\(V = \exp\big(\frac{-D}{r}\big)\)</span> where <span class="math inline">\(r\)</span> is a parameter that dictates the range of spatial autocorrelation. The function <code>covar_exp()</code> corresponds to this covariance function.</p>
<p><span class="math inline">\(V\)</span> represents the correlation among points if all variation is accounted for. However, in most cases, some additional source of unexplained and unmeasured variance (a nugget <span class="math inline">\(\eta\)</span>) occurs. To account for this, we assume that covariance structure among pixels is given by <span class="math inline">\(\Sigma = \eta I + (1-\eta)V\)</span> where <span class="math inline">\(I\)</span> is an identity matrix.</p>
<p>If we know the range parameter, we can calculate <code>V</code>, from <code>D</code> with <code>covar_exp()</code>:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>r <span class="ot">=</span> <span class="fl">0.1</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>V <span class="ot">=</span> <span class="fu">covar_exp</span>(D, r)</span></code></pre></div>
<p>And we could add a known nugget to <code>V</code> to obtain <code>Sigma</code>:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>nugget <span class="ot">=</span> <span class="fl">0.2</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>I <span class="ot">=</span> <span class="fu">diag</span>(<span class="fu">nrow</span>(V)) <span class="co"># identity matrix</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>Sigma <span class="ot">=</span> nugget<span class="sc">*</span>I <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>nugget)<span class="sc">*</span>V</span></code></pre></div>
<p>See <code>?covar_exp()</code> to see the covariance functions provided by <code>remotePARTS</code> and for more information regarding their usage.</p>
</div>
</div>
<div id="gls-3000-pixel-subset" class="section level1">
<h1>GLS: 3000-pixel subset</h1>
<p>To test spatial hypotheses with <code>remotePARTS</code> a generalized least squares regression model (GLS) is fit The GLS follows</p>
<p><span class="math display">\[\theta = \alpha_{gls}X + \varepsilon \]</span> where</p>
<ul>
<li><p><span class="math inline">\(\theta\)</span> is a response vector of values that are spatially autocorrelated</p></li>
<li><p><span class="math inline">\(\alpha_{gls}\)</span> is a vector of the effects of predictor variables <span class="math inline">\(X\)</span> on <span class="math inline">\(\theta\)</span></p></li>
<li><p>and the error term is spatially autocorrelated according to <span class="math inline">\(\Sigma\)</span>: <span class="math inline">\(\varepsilon \sim N(0, \Sigma)\)</span></p></li>
</ul>
<p><span class="math inline">\(\theta\)</span> will usually be a regression parameter. For example, if we’re interested in understanding trends in NDVI over time, we would use the pixel-level regression coefficient for the effect of time on NDVI (i.e., <span class="math inline">\(\theta = \hat\beta\)</span>)</p>
<div id="known-parameters" class="section level2">
<h2>Known parameters</h2>
<p>If the parameters are known a GLS can easily be fit with <code>fitGLS()</code>. Here, we will fit the GLS by providing 1) a model formula, 2) a data source, 3) our <code>V</code> matrix, which was pre-calculated with our spatial parameter <span class="math inline">\(r = 0.1\)</span>, and 4) our nugget (<span class="math inline">\(\eta = 0.2\)</span>).</p>
<p>In this example, we will estimate the effect of land cover class on our time trend. Because <code>land</code> is a factor, we’ll also specify a no-intercept model.</p>
<p>Note that the GLS fitting process requires an inversion of <code>V</code>. This means that even with only the 3000-pixel subset, it will take a few minutes to finish the computations on most computers.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>GLS<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">fitGLS</span>(<span class="at">formula =</span> AR_coef <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> land, <span class="at">data =</span> ndvi_AK3000, <span class="at">V =</span> V, <span class="at">nugget =</span> nugget)</span></code></pre></div>
<p>Note also that <code>fitGLS</code> adds the nugget to <code>V</code> internally. If we wanted to do this ourselves, we could pass the covariance matrix <code>Sigma</code>, which already contains a nugget component, and then set the <code>nugget</code> argument of <code>fitGLS</code> to 0:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitGLS</span>(<span class="at">formula =</span> AR_coef <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> land, <span class="at">data =</span> ndvi_AK3000, <span class="at">V =</span> Sigma, <span class="at">nugget =</span> <span class="dv">0</span>) <span class="co"># equivalent</span></span></code></pre></div>
<p>The estimates for our land class effects can be extracted with <code>coefficients()</code>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coefficients</span>(GLS<span class="fl">.0</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="do">## landShrubland   landSavanna landGrassland </span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  -0.002644554  -0.007009724  -0.001313971</span></span></code></pre></div>
</div>
<div id="parameter-estimation" class="section level2">
<h2>Parameter estimation</h2>
<p>In practice, we rarely know the spatial parameters or the nugget in advance. So, these parameters will need to be estimated for most data.</p>
<div id="spatial-parameters" class="section level3">
<h3>Spatial parameters</h3>
<p>The spatial parameters of a covariance function, such as <code>covar_exp</code>, can be estimated from residuals of pixel-level time series models. Although we conducted the time series analyses as though each pixel was independent (with <code>fitAR_map</code>), they are, in fact, dependent. Specifically, these pixel-level analyses are correlated proportionally to the spatial autocorrelation of our response variable <span class="math inline">\(Y\)</span> (NDVI). Therefore, we can find the <span class="math inline">\(V\)</span> that is best associated with the correlation among pixel-level time series residuals. In the case of <code>covar_exp</code>, we find the range parameter that most closely transforms <code>D</code> into <span class="math inline">\(V \approx \text{cor}\big(\varepsilon_i(t), \varepsilon_j(t)\big)\)</span></p>
<p>The function <code>fitCor()</code> does just that. We will pass this function 1) the time series residuals for our map, extracted from the time series analysis output object with <code>residuals()</code>, 2) the coordinate matrix <code>coords</code>, 3) the covariance function <code>covar_exp()</code>, and 4) a list specifying that we should start the search for the optimal range parameter at 0.1. For this example, we will also specify <code>fit.n = 3000</code>, which ensures that all pixels are used to estimate spatial parameters.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>corfit <span class="ot">=</span> <span class="fu">fitCor</span>(<span class="at">resids =</span> <span class="fu">residuals</span>(ARfit), <span class="at">coords =</span> coords, </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">covar_FUN =</span> <span class="st">&quot;covar_exp&quot;</span>, <span class="at">start =</span> <span class="fu">list</span>(<span class="at">range =</span> <span class="fl">0.1</span>), </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">fit.n =</span> <span class="dv">3000</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>(<span class="at">range.opt =</span> corfit<span class="sc">$</span>spcor)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="do">##     range </span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.1158415</span></span></code></pre></div>
<p>By default, <code>fitCor</code> uses <code>distm_scaled</code> to calculate distances from the coordinate matrix but any function that returns a distance matrix can be specified with the <code>distm_FUN</code> argument. It is important to scale the parameter values appropriately with your distances. For example, if we instead use <code>distm_km()</code> to calculate distance in km instead of relative distances, we would need to scale our starting range parameter by the maximum distance, in km of our map:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>max.dist <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">distm_km</span>(coords))</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>corfit.km <span class="ot">=</span> <span class="fu">fitCor</span>(<span class="at">resids =</span> <span class="fu">residuals</span>(ARfit), <span class="at">coords =</span> coords, </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">covar_FUN =</span> <span class="st">&quot;covar_exp&quot;</span>, <span class="at">start =</span> <span class="fu">list</span>(<span class="at">range =</span> max.dist<span class="sc">*</span><span class="fl">0.1</span>),</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">distm_FUN =</span> <span class="st">&quot;distm_km&quot;</span>, <span class="at">fit.n =</span> <span class="dv">3000</span>)</span></code></pre></div>
<p>Note that, depending on the covariance function used, not all parameters will need scaling. For example, <code>covar_exppow()</code> is an exponential-power covariance function and takes a range and shape parameter, but only the range parameter should scale with distance.</p>
<p>See <code>?fitCor()</code> for more details.</p>
<p>After we’ve obtained our range parameter estimate, we can use it to re-calculate the <code>V</code> matrix:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>V.opt <span class="ot">=</span> <span class="fu">covar_exp</span>(D, range.opt)</span></code></pre></div>
</div>
<div id="nugget" class="section level3">
<h3>Nugget</h3>
<p>Similar to finding the optimal spatial parameters, the optimal nugget can be estimated by selecting a nugget that maximizes the likelihood of the GLS, given the data. <code>fitGLS</code> will find this maximum likelihood nugget when <code>nugget = NA</code> is specified. Note that this type of optimization requires fitting multiple GLS models, which means it will be much slower than even our call to <code>fitGLS</code> with a known nugget.</p>
<p>In addition to our original arguments, we’ll also set <code>no_F = FALSE</code> so that F-tests are calculated. This will be discussed further in the “Hypothesis testing” section.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>GLS.opt <span class="ot">=</span> <span class="fu">fitGLS</span>(<span class="at">formula =</span> AR_coef <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> land, <span class="at">data =</span> ndvi_AK3000, <span class="at">V =</span> V.opt, <span class="at">nugget =</span> <span class="cn">NA</span>, </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">no_F =</span> <span class="cn">FALSE</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>(<span class="at">nug.opt =</span> GLS.opt<span class="sc">$</span>nugget)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.1611184</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="fu">coefficients</span>(GLS.opt)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="do">## landShrubland   landSavanna landGrassland </span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  -0.002593997  -0.006794167  -0.001221789</span></span></code></pre></div>
<p>Let’s compare our GLS from earlier with this one with optimized parameters:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="at">GLS.0 =</span> <span class="fu">c</span>(<span class="at">range =</span> r, <span class="at">nugget =</span> GLS<span class="fl">.0</span><span class="sc">$</span>nugget, <span class="at">LL =</span> GLS<span class="fl">.0</span><span class="sc">$</span>LL, <span class="at">MSE =</span> GLS<span class="fl">.0</span><span class="sc">$</span>MSE),</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">GLS.opt =</span> <span class="fu">c</span>(<span class="at">range =</span> range.opt, <span class="at">nugget =</span> GLS.opt<span class="sc">$</span>nugget, <span class="at">LL =</span> GLS.opt<span class="sc">$</span>LL, <span class="at">MSE =</span> GLS.opt<span class="sc">$</span>MSE))</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="do">##             range    nugget       LL         MSE</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="do">## GLS.0   0.1000000 0.2000000 6929.203 0.001868944</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="do">## GLS.opt 0.1158415 0.1611184 6928.150 0.002245706</span></span></code></pre></div>
</div>
<div id="simultaneous-parameter-estimation" class="section level3">
<h3>Simultaneous parameter estimation</h3>
<p>It is also possible to simultaneously estimate spatial parameters and the nugget, without using time series residuals. This is done by finding both the set of parameters that maximizes the likelihood of a GLS, given the data. This function is much slower even than optimizing the nugget alone with <code>fitGLS</code>. Therefore, it will not be executed in this example, but the following code could be used to fit a GLS with parameters fully optimized from the data.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>fitopt <span class="ot">&lt;-</span> <span class="fu">optimize_GLS</span>(<span class="at">formula =</span> AR_coef <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> land, <span class="at">data =</span> ndvi_AK3000, </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">coords =</span> ndvi_AK3000[, <span class="fu">c</span>(<span class="st">&quot;lng&quot;</span>, <span class="st">&quot;lat&quot;</span>)], </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">covar_FUN =</span> <span class="st">&quot;covar_exp&quot;</span>, </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">start =</span> <span class="fu">c</span>(<span class="at">range =</span> .<span class="dv">1</span>, <span class="at">nugget =</span> .<span class="dv">2</span>))</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>fitopt<span class="sc">$</span>opt<span class="sc">$</span>par</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="do">##      range     nugget </span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.02907116 0.30272255</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>fitopt<span class="sc">$</span>GLS<span class="sc">$</span>LL</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 6941.524</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>fitopt<span class="sc">$</span>GLS<span class="sc">$</span>MSE</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.001033084</span></span></code></pre></div>
<p>Note that, because <code>optimize_GLS()</code> does not require time series residuals, it is possible to fit this style of GLS to any spatial variable. In other words, rather than <span class="math inline">\(\theta\)</span> being a limited to a time trend, it can be a purely spatial variable as well.</p>
<p>When time series residuals are available, it is recommended to estimate spatial parameters with <code>fitCor</code> rather than <code>optimize_GLS</code>. The covariance matrix obtained from <code>fitCor</code> will more closely resemble the spatial autocorrelation than a covariance matrix derived from <code>optimize_GLS</code> parameters.</p>
<p>See <code>?optimize_GLS()</code> for more information about this function and its usage.</p>
</div>
</div>
</div>
<div id="hypothesis-testing" class="section level1">
<h1>Hypothesis testing</h1>
<p>The purpose of the tools provided by <code>remotePARTS</code> is to test map-level hypothesis about spatiotemporal data sets. In this example, we will test 3 hypotheses, using 3 different GLS models.</p>
<div id="intercept-only-model" class="section level2">
<h2>Intercept-only model</h2>
<p>If we want to test the hypothesis that “there was a trend in Alaska NDVI Alaska from 1982-2013”, we can regress the AR coefficient on an intercept only GLS model:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>(GLS.int <span class="ot">&lt;-</span> <span class="fu">fitGLS</span>(AR_coef <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> ndvi_AK3000,<span class="at">V =</span> V.opt, <span class="at">nugget =</span> nug.opt))</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="do">## fitGLS(formula = AR_coef ~ 1, data = ndvi_AK3000, V = V.opt, </span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="do">##     nugget = nug.opt)</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="do">## t-tests:</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="do">##                  Est  t.stat pval.t</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept) -0.00241 -0.1686 0.8661</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Model statistics:</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="do">##     SSE     MSE   LL</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 6.748 0.00225 6924</span></span></code></pre></div>
<p>And we can see from the t-test that the intercept is not statistically different from zero. In other words, there is no map-level temporal trend in NDVI.</p>
</div>
<div id="land-cover-effects" class="section level2">
<h2>Land cover effects</h2>
<p>If we want to test the hypothesis that “Trends in Alaskan NDVI differ by land cover class”, we can use <code>GLS.opt</code> from earlier:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>GLS.opt</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="do">## fitGLS(formula = AR_coef ~ 0 + land, data = ndvi_AK3000, V = V.opt, </span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="do">##     nugget = NA, no_F = FALSE)</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="do">## t-tests:</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="do">##                     Est   t.stat pval.t</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="do">## landShrubland -0.002594 -0.18080 0.8565</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="do">## landSavanna   -0.006794 -0.47278 0.6364</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="do">## landGrassland -0.001222 -0.08549 0.9319</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="do">## F-test:</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="do">##                model df_F   SSE      MSE   LL Fstat  pval_F</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 AR_coef ~ 0 + land    2 6.730 0.002246 6928 3.988 0.01864</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="do">## 2        AR_coef ~ 1 2997 6.748 0.002252 6923    NA      NA</span></span></code></pre></div>
<p>The t-tests show that the trend in NDVI, for all land cover classes, was not statistically different from zero, meaning there was no differents in NDVI trend among land cover classes.</p>
<p>The ANOVA table (F-tests), however, shows that land a the land class model explained significantly more variation that the intercept-only model.</p>
</div>
<div id="latitude-effects" class="section level2">
<h2>Latitude effects</h2>
<p>Finally, to test the hypothesis that “temporal trends in NDVI differ with latitude”, we can regress the AR coefficient on latitude in our GLS model:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>(GLS.lat <span class="ot">&lt;-</span> <span class="fu">fitGLS</span>(AR_coef <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> lat, <span class="at">data =</span> ndvi_AK3000, <span class="at">V =</span> V.opt, <span class="at">nugget =</span> nug.opt,</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">no_F =</span> <span class="cn">FALSE</span>))</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="do">## fitGLS(formula = AR_coef ~ 1 + lat, data = ndvi_AK3000, V = V.opt, </span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="do">##     nugget = nug.opt, no_F = FALSE)</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="do">## t-tests:</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="do">##                   Est  t.stat pval.t</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept) -0.080937 -0.5817 0.5608</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="do">## lat          0.001271  0.5673 0.5705</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="do">## F-test:</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="do">##               model df_F   SSE      MSE   LL  Fstat pval_F</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 AR_coef ~ 1 + lat    1 6.748 0.002251 6924 0.3219 0.5705</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a><span class="do">## 2       AR_coef ~ 1 2998 6.748 0.002251 6924     NA     NA</span></span></code></pre></div>
<p>The t-tests show that temporal trends in NDVI did not differ with latitude, nor across the entire map after accounting for latitude effects.</p>
</div>
<div id="conclusions-ndvi_ak3000" class="section level2">
<h2>Conclusions (ndvi_AK3000)</h2>
<p>We can see from these hypothesis tests that, at least among the 3000-pixel sub-sample of Alaska, there are no significant temporal trends in NDVI, independent of spatial and temporal autocorrelation.</p>
<p>Note that the p-value from the F-test is equivalent to that of the t-test p-value for effect of latitude.</p>
</div>
</div>
<div id="gls-full-dataset" class="section level1">
<h1>GLS: Full dataset</h1>
<p>Until now, we have limited our analyses to the 3000-pixel subset of Alaska, <code>ndvi_AK3000</code>. Calls to <code>fitGLS()</code> involve inverting <code>V</code> and the computational complexity is not linear but, rather, <span class="math inline">\(N^3\)</span> where <span class="math inline">\(N\)</span> is the number of pixels in the map. So, one reason to use <code>ndvi_AK3000</code> until this point is compute time efficiency. 3000 pixels means dealing with distance and covariance matrices that each contain <span class="math inline">\(3,000 \times 3,000 = 9,000,000\)</span> elements. This is approaching the upper size limit for obtaining relatively fast results.</p>
<p>By contrast, the covariance matrix for the full <code>ndvi_AK</code> data set would have <span class="math inline">\(31,486 \times 31,486 = 991,368,196\)</span> elements which is totally unfeasible for a normal computer to invert and would take an very long time to do so anyhow.</p>
<p>For these reasons, <code>fitGLS_paritition()</code> may be the most useful function in the <code>remotePARTS</code> package. This function can perform the GLS analysis on the full <code>ndvi_AK</code> data set. In fact, <code>ndvi_AK</code> is quite small in comparison to many remote sensing data sets that could be analyzed with <code>fitGLS_partition()</code>.</p>
<div id="partitioned-gls" class="section level2">
<h2>Partitioned GLS</h2>
<p><code>fitGLS_parition()</code> conducts a partitioned GLS. This process 1) breaks the data into smaller and more manageable pieces (partitions), 2) conducts GLS on each partition, 3) calculates cross-partition statistics from pairs of partitions, and 4) summarizes the results with statistical tests that account for correlations among partitions. We will use the full <code>ndvi_AK</code> datasheet to demonstrate this functionality.</p>
<p>The first step, in this case, is to filter the data set by removing rare land cover classes. Each partition needs to have the same coefficients.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> ndvi_AK[<span class="sc">!</span>ndvi_AK<span class="sc">$</span>rare.land, ]</span></code></pre></div>
<p>The next step is to divide pixels up into their parititons. The function <code>sample_parition()</code> can do this for us. Passing <code>sample_partitions</code> the number of pixels in our map and the argument <code>partsize = 1500</code> will result in a partition matrix with 1,500 rows and 20 columns. Columns of the resulting partition matrix <code>pm</code> each contain a random sample of 1,500 pixels. Each of these 20 samples (partitions) are non-overlapping, containing no repeats.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>pm <span class="ot">&lt;-</span> <span class="fu">sample_partitions</span>(<span class="at">npix =</span> <span class="fu">nrow</span>(df), <span class="at">partsize =</span> <span class="dv">1500</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;calculating npart&quot;</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(pm)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1500   20</span></span></code></pre></div>
<p>Once we have our partition matrix and our filtered data, we can run the analysis by passing <code>fitGLS_parititon</code>. The input is similar to <code>fitGLS</code>. For this example, we specify 1) a formula, 2) the data <code>df</code>, 3) the partmat <code>pm</code>, 4) the covariance function, 5) a list of spatial parameters including our optimized range parameter, and 6) our optimized nugget.</p>
<p>Note that, though the compute time is much faster than if we needed to invert the full covariance matrix, this example still takes a very long time to fit. For that reason, we have saved the output of this code as an R object <code>partGLS_ndviAK</code>, so that you can look at its output without having to execute the function.</p>
<p>The model was fit with this code:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>partGLS_ndviAK <span class="ot">&lt;-</span> <span class="fu">fitGLS_partition</span>(<span class="at">formula =</span> AR_coef <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> land, <span class="at">data =</span> df, </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">partmat =</span> pm, <span class="at">covar_FUN =</span> <span class="st">&quot;covar_exp&quot;</span>, </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">covar_pars =</span> <span class="fu">list</span>(<span class="at">range =</span> range.opt),</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">nugget =</span> nug.opt)</span></code></pre></div>
<p>and can be loaded with</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(partGLS_ndviAK)</span></code></pre></div>
<p>Here are the t-tests, that show that land cover class does not significantly affect NDVI trend:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>partGLS_ndviAK<span class="sc">$</span>overall<span class="sc">$</span>t_test</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="do">##                        Est         SE     t.stat    pval.t</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="do">## landShrubland  0.003946219 0.01310114  0.3012120 0.7632550</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="do">## landSavanna   -0.002604683 0.01311682 -0.1985758 0.8425959</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="do">## landGrassland  0.003814531 0.01307092  0.2918334 0.7704160</span></span></code></pre></div>
<p>It is <strong>highly</strong> recommended that users read the full documentation (<code>?fitGLS_parition()</code>) before using <code>fitGLS_partition</code> to analyze any data.</p>
<div id="chisqr-test-problem" class="section level5">
<h5>Chisqr-test problem</h5>
<p>Here is the p-value for the chisqr test of the partitioned GLS, it seems very wrong:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>partGLS_ndviAK<span class="sc">$</span>overall<span class="sc">$</span>pval.chisqr</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="do">## pval.chisqr </span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="do">##       1e-06</span></span></code></pre></div>
<p>Here’s a manual test:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">stats =</span> <span class="fu">with</span>(partGLS_ndviAK<span class="sc">$</span>overall, <span class="fu">c</span>(<span class="at">Fmean =</span> Fstat, <span class="at">rSSR =</span> rSSR, dfs[<span class="dv">1</span>], partdims[<span class="st">&quot;npart&quot;</span>])))</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="do">##       Fmean        rSSR         df1       npart </span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  4.56127201  0.03100223  2.00000000 20.00000000</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="do">## use function</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>remotePARTS<span class="sc">:::</span><span class="fu">part_chisqr</span>(stats[<span class="st">&quot;Fmean&quot;</span>], stats[<span class="st">&quot;rSSR&quot;</span>], stats[<span class="st">&quot;df1&quot;</span>], stats[<span class="st">&quot;npart&quot;</span>])</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="do">## pval.chisqr </span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="do">##       1e-06 </span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="do">## attr(,&quot;rankdef.MSR&quot;)</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="do">## test manually</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>(<span class="at">rZ =</span> (stats[<span class="st">&quot;rSSR&quot;</span>]<span class="sc">/</span>stats[<span class="st">&quot;df1&quot;</span>])<span class="sc">^</span><span class="fl">0.5</span>)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="do">##      rSSR </span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.1245035</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>(<span class="at">v.MSR =</span> <span class="fu">diag</span>(stats[<span class="st">&quot;df1&quot;</span>]) <span class="sc">-</span> rZ)</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a><span class="do">##            [,1]       [,2]</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a><span class="do">## [1,]  0.8754965 -0.1245035</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a><span class="do">## [2,] -0.1245035  0.8754965</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>V.MSR <span class="ot">=</span> <span class="fu">kronecker</span>(<span class="fu">diag</span>(stats[<span class="st">&quot;npart&quot;</span>]), v.MSR) <span class="sc">+</span> rZ</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>(<span class="at">lambda =</span> <span class="fu">eigen</span>(V.MSR)<span class="sc">$</span>values)</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1] 5.7311320 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a><span class="do">##  [8] 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000</span></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a><span class="do">## [15] 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a><span class="do">## [22] 0.7509931 0.7509931 0.7509931 0.7509931 0.7509931 0.7509931 0.7509931</span></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a><span class="do">## [29] 0.7509931 0.7509931 0.7509931 0.7509931 0.7509931 0.7509931 0.7509931</span></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a><span class="do">## [36] 0.7509931 0.7509931 0.7509931 0.7509931 0.7509931</span></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>(<span class="at">pval =</span> CompQuadForm<span class="sc">::</span><span class="fu">imhof</span>(<span class="at">q =</span> stats[<span class="st">&quot;npart&quot;</span>] <span class="sc">*</span> stats[<span class="st">&quot;df1&quot;</span>] <span class="sc">*</span> stats[<span class="st">&quot;Fmean&quot;</span>], <span class="at">lambda =</span> lambda)<span class="sc">$</span>Qq)</span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 5.231899e-07</span></span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>(<span class="at">pval.print =</span> <span class="fu">ifelse</span>(pval <span class="sc">&lt;</span> <span class="fl">1e-6</span>, <span class="fl">1e-6</span>, pval))</span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1e-06</span></span></code></pre></div>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
